From 00063fc51524453430bb9325ec5889b10f01cfbb Mon Sep 17 00:00:00 2001
From: Jason Hung <jhung@globalscaletechnologies.com>
Date: Thu, 23 Jan 2025 09:56:08 +0800
Subject: [PATCH 4/9] board: mt8370: turn on regulator at boot if
 'regulator-boot-on' flag enabled

---
 board/mediatek/mt8370/mt8370_evk.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/board/mediatek/mt8370/mt8370_evk.c b/board/mediatek/mt8370/mt8370_evk.c
index dccd4e72fd..a44745ef60 100644
--- a/board/mediatek/mt8370/mt8370_evk.c
+++ b/board/mediatek/mt8370/mt8370_evk.c
@@ -10,6 +10,7 @@
 #include <iot_ab.h>
 #include <net.h>
 #include <asm/io.h>
+#include <power/regulator.h>
 #include <linux/kernel.h>
 #include <linux/arm-smccc.h>
 #include <splash.h>
@@ -179,6 +180,11 @@ int board_init(void)
 	struct udevice *dev;
 	int ret;
 
+	/* turn on regulator at boot if 'regulator-boot-on' flag enabled */
+	if (IS_ENABLED(CONFIG_DM_REGULATOR) && board_is_gti_mt510ss_evk()) {
+		regulators_enable_boot_on(_DEBUG);
+	}
+
 	if (CONFIG_IS_ENABLED(USB_GADGET)) {
 		ret = uclass_get_device(UCLASS_USB_GADGET_GENERIC, 0, &dev);
 		if (ret) {
-- 
2.47.1

